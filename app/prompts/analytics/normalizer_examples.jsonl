{"input": {"user_query": "Quantos pedidos temos no total?", "sql": "SELECT COUNT(*) AS total_orders FROM analytics.orders", "rows": [{"total_orders": 99441}], "row_count": 1, "limit_applied": false}, "output": {"text": "Existem 99.441 pedidos no sistema.", "meta": {"sql": "SELECT COUNT(*) AS total_orders FROM analytics.orders", "row_count": 1, "limit_applied": false}}}
{"input": {"user_query": "Qual é a receita total por estado?", "sql": "SELECT c.customer_state, SUM(oi.price + oi.freight_value) AS revenue FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state ORDER BY revenue DESC", "rows": [{"customer_state": "SP", "revenue": 1234567.89}, {"customer_state": "RJ", "revenue": 987654.32}, {"customer_state": "MG", "revenue": 543210.98}], "row_count": 3, "limit_applied": false}, "output": {"text": "Receita por estado:\n  SP: R$ 1.234.567,89\n  RJ: R$ 987.654,32\n  MG: R$ 543.210,98\n\nTotal: R$ 2.765.433,19", "meta": {"sql": "SELECT c.customer_state, SUM(oi.price + oi.freight_value) AS revenue FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state ORDER BY revenue DESC", "row_count": 3, "limit_applied": false}}}
{"input": {"user_query": "Top 5 produtos com maior margem de contribuição", "sql": "SELECT oi.product_id, SUM(oi.price + oi.freight_value) AS contribution_margin FROM analytics.order_items oi GROUP BY oi.product_id ORDER BY contribution_margin DESC LIMIT 5", "rows": [{"product_id": "abc123", "contribution_margin": 67606.10}, {"product_id": "def456", "contribution_margin": 60976.03}, {"product_id": "ghi789", "contribution_margin": 59093.99}, {"product_id": "jkl012", "contribution_margin": 51071.60}, {"product_id": "mno345", "contribution_margin": 50326.18}], "row_count": 5, "limit_applied": true}, "output": {"text": "Top 5 produtos por margem de contribuição:\n  1. abc123: R$ 67.606,10\n  2. def456: R$ 60.976,03\n  3. ghi789: R$ 59.093,99\n  4. jkl012: R$ 51.071,60\n  5. mno345: R$ 50.326,18", "meta": {"sql": "SELECT oi.product_id, SUM(oi.price + oi.freight_value) AS contribution_margin FROM analytics.order_items oi GROUP BY oi.product_id ORDER BY contribution_margin DESC LIMIT 5", "row_count": 5, "limit_applied": true}}}
{"input": {"user_query": "Distribuição de clientes por estado", "sql": "SELECT customer_state, COUNT(*) AS customer_count FROM analytics.customers GROUP BY customer_state ORDER BY customer_count DESC", "rows": [{"customer_state": "SP", "customer_count": 41746}, {"customer_state": "RJ", "customer_count": 12852}, {"customer_state": "MG", "customer_count": 11635}, {"customer_state": "RS", "customer_count": 5466}], "row_count": 4, "limit_applied": false}, "output": {"text": "Distribuição de clientes por estado:\n  SP: 41.746\n  RJ: 12.852\n  MG: 11.635\n  RS: 5.466\n\nTotal: 71.699 clientes em 4 estados.", "meta": {"sql": "SELECT customer_state, COUNT(*) AS customer_count FROM analytics.customers GROUP BY customer_state ORDER BY customer_count DESC", "row_count": 4, "limit_applied": false}}}
{"input": {"user_query": "Qual é a receita média por pedido por estado?", "sql": "SELECT c.customer_state, AVG(oi.price + oi.freight_value) AS average_revenue FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state ORDER BY average_revenue DESC", "rows": [{"customer_state": "PB", "average_revenue": 234.20}, {"customer_state": "AL", "average_revenue": 216.73}, {"customer_state": "AC", "average_revenue": 213.80}], "row_count": 3, "limit_applied": false}, "output": {"text": "Receita média por pedido por estado:\n  PB: R$ 234,20 (média)\n  AL: R$ 216,73 (média)\n  AC: R$ 213,80 (média)", "meta": {"sql": "SELECT c.customer_state, AVG(oi.price + oi.freight_value) AS average_revenue FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state ORDER BY average_revenue DESC", "row_count": 3, "limit_applied": false}}}
{"input": {"user_query": "Compare a receita entre diferentes métodos de pagamento", "sql": "SELECT op.payment_type, SUM(oi.price + oi.freight_value) AS revenue FROM analytics.order_payments op JOIN analytics.orders o ON op.order_id = o.order_id JOIN analytics.order_items oi ON o.order_id = oi.order_id GROUP BY op.payment_type ORDER BY revenue DESC", "rows": [{"payment_type": "credit_card", "revenue": 8945672.34}, {"payment_type": "boleto", "revenue": 6234567.89}, {"payment_type": "debit_card", "revenue": 2345678.90}], "row_count": 3, "limit_applied": false}, "output": {"text": "Receita por método de pagamento:\n  credit_card: R$ 8.945.672,34\n  boleto: R$ 6.234.567,89\n  debit_card: R$ 2.345.678,90\n\nTotal: R$ 17.525.919,13", "meta": {"sql": "SELECT op.payment_type, SUM(oi.price + oi.freight_value) AS revenue FROM analytics.order_payments op JOIN analytics.orders o ON op.order_id = o.order_id JOIN analytics.order_items oi ON o.order_id = oi.order_id GROUP BY op.payment_type ORDER BY revenue DESC", "row_count": 3, "limit_applied": false}}}
{"input": {"user_query": "Qual é a correlação entre valor do frete e taxa de cancelamento por região?", "sql": "SELECT c.customer_state, AVG(oi.freight_value) AS avg_freight, COUNT(CASE WHEN o.order_status LIKE '%cancel%' THEN 1 END) AS cancellation_count FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state", "rows": [{"customer_state": "SP", "avg_freight": 15.15, "cancellation_count": 293}, {"customer_state": "RJ", "avg_freight": 20.96, "cancellation_count": 69}, {"customer_state": "MG", "avg_freight": 20.63, "cancellation_count": 56}], "row_count": 3, "limit_applied": false}, "output": {"text": "Análise de correlação frete vs cancelamento por região:\n  SP: Frete R$ 15,15, Cancelamentos: 293\n  RJ: Frete R$ 20,96, Cancelamentos: 69\n  MG: Frete R$ 20,63, Cancelamentos: 56\n\nMédias gerais: Frete R$ 18,91, Cancelamentos: 139", "meta": {"sql": "SELECT c.customer_state, AVG(oi.freight_value) AS avg_freight, COUNT(CASE WHEN o.order_status LIKE '%cancel%' THEN 1 END) AS cancellation_count FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state", "row_count": 3, "limit_applied": false}}}
{"input": {"user_query": "Evolução mensal de pedidos em 2017", "sql": "SELECT date_trunc('month', order_purchase_timestamp) AS period, COUNT(*) AS order_count FROM analytics.orders WHERE order_purchase_timestamp >= '2017-01-01' AND order_purchase_timestamp < '2018-01-01' GROUP BY period ORDER BY period", "rows": [{"period": "2017-01-01T00:00:00", "order_count": 1234}, {"period": "2017-02-01T00:00:00", "order_count": 1456}, {"period": "2017-03-01T00:00:00", "order_count": 1678}], "row_count": 3, "limit_applied": false}, "output": {"text": "Evolução mensal de pedidos em 2017:\n  Janeiro: 1.234 pedidos\n  Fevereiro: 1.456 pedidos\n  Março: 1.678 pedidos\n\nTotal: 4.368 pedidos em 3 meses analisados.", "meta": {"sql": "SELECT date_trunc('month', order_purchase_timestamp) AS period, COUNT(*) AS order_count FROM analytics.orders WHERE order_purchase_timestamp >= '2017-01-01' AND order_purchase_timestamp < '2018-01-01' GROUP BY period ORDER BY period", "row_count": 3, "limit_applied": false}}}
{"input": {"user_query": "Taxa de cancelamento por estado", "sql": "SELECT c.customer_state, 100.0 * COUNT(CASE WHEN o.order_status LIKE '%cancel%' THEN 1 END) / NULLIF(COUNT(*), 0) AS cancellation_rate FROM analytics.orders o JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state ORDER BY cancellation_rate DESC", "rows": [{"customer_state": "RR", "cancellation_rate": 4.35}, {"customer_state": "AM", "cancellation_rate": 3.21}, {"customer_state": "PA", "cancellation_rate": 2.87}], "row_count": 3, "limit_applied": false}, "output": {"text": "Taxa de cancelamento por estado:\n  RR: 4,35%\n  AM: 3,21%\n  PA: 2,87%", "meta": {"sql": "SELECT c.customer_state, 100.0 * COUNT(CASE WHEN o.order_status LIKE '%cancel%' THEN 1 END) / NULLIF(COUNT(*), 0) AS cancellation_rate FROM analytics.orders o JOIN analytics.customers c ON o.customer_id = c.customer_id GROUP BY c.customer_state ORDER BY cancellation_rate DESC", "row_count": 3, "limit_applied": false}}}
{"input": {"user_query": "Qual é a receita por método de pagamento?", "sql": "SELECT op.payment_type, SUM(oi.price + oi.freight_value) AS revenue FROM analytics.order_payments op JOIN analytics.orders o ON op.order_id = o.order_id JOIN analytics.order_items oi ON o.order_id = oi.order_id GROUP BY op.payment_type ORDER BY revenue DESC", "rows": [{"payment_type": "credit_card", "revenue": 12723914.88}, {"payment_type": "boleto", "revenue": 2842240.29}, {"payment_type": "voucher", "revenue": 785081.94}, {"payment_type": "debit_card", "revenue": 215306.74}], "row_count": 4, "limit_applied": false}, "output": {"text": "Receita por método de pagamento:\n  credit_card: R$ 12.723.914,88\n  boleto: R$ 2.842.240,29\n  voucher: R$ 785.081,94\n  debit_card: R$ 215.306,74\n\nTotal: R$ 16.566.543,85", "meta": {"sql": "SELECT op.payment_type, SUM(oi.price + oi.freight_value) AS revenue FROM analytics.order_payments op JOIN analytics.orders o ON op.order_id = o.order_id JOIN analytics.order_items oi ON o.order_id = oi.order_id GROUP BY op.payment_type ORDER BY revenue DESC", "row_count": 4, "limit_applied": false}}}
{"input": {"user_query": "Top 5 produtos por receita total", "sql": "SELECT oi.product_id, SUM(oi.price + oi.freight_value) AS total_revenue FROM analytics.order_items oi JOIN analytics.orders o ON oi.order_id = o.order_id GROUP BY oi.product_id ORDER BY total_revenue DESC LIMIT 5", "rows": [{"product_id": "bb50f2e236e5eea0100680137654686c", "total_revenue": 67606.10}, {"product_id": "d1c427060a0f73f6b889a5c7c61f2ac4", "total_revenue": 60976.03}, {"product_id": "6cdd53843498f92890544667809f1595", "total_revenue": 59093.99}, {"product_id": "99a4788cb24856965c36a24e339b6058", "total_revenue": 51071.60}, {"product_id": "d6160fb7873f184099d9bc95e30376af", "total_revenue": 50326.18}], "row_count": 5, "limit_applied": true}, "output": {"text": "Top 5 produtos por receita total:\n  1. bb50f2e236e5eea0100680137654686c: R$ 67.606,10\n  2. d1c427060a0f73f6b889a5c7c61f2ac4: R$ 60.976,03\n  3. 6cdd53843498f92890544667809f1595: R$ 59.093,99\n  4. 99a4788cb24856965c36a24e339b6058: R$ 51.071,60\n  5. d6160fb7873f184099d9bc95e30376af: R$ 50.326,18", "meta": {"sql": "SELECT oi.product_id, SUM(oi.price + oi.freight_value) AS total_revenue FROM analytics.order_items oi JOIN analytics.orders o ON oi.order_id = o.order_id GROUP BY oi.product_id ORDER BY total_revenue DESC LIMIT 5", "row_count": 5, "limit_applied": true}}}
{"input": {"user_query": "Distribuição de clientes por estado (todos os estados)", "sql": "SELECT customer_state, COUNT(*) AS customer_count FROM analytics.customers GROUP BY customer_state ORDER BY customer_count DESC", "rows": [{"customer_state": "SP", "customer_count": 41746}, {"customer_state": "RJ", "customer_count": 12852}, {"customer_state": "MG", "customer_count": 11635}, {"customer_state": "RS", "customer_count": 5466}, {"customer_state": "PR", "customer_count": 5045}, {"customer_state": "SC", "customer_count": 3637}, {"customer_state": "BA", "customer_count": 3380}, {"customer_state": "DF", "customer_count": 2140}, {"customer_state": "ES", "customer_count": 2033}, {"customer_state": "GO", "customer_count": 2020}, {"customer_state": "PE", "customer_count": 1652}, {"customer_state": "CE", "customer_count": 1336}, {"customer_state": "PA", "customer_count": 975}, {"customer_state": "MT", "customer_count": 907}, {"customer_state": "MA", "customer_count": 747}, {"customer_state": "MS", "customer_count": 715}, {"customer_state": "PB", "customer_count": 536}, {"customer_state": "PI", "customer_count": 495}, {"customer_state": "RN", "customer_count": 485}, {"customer_state": "AL", "customer_count": 413}, {"customer_state": "SE", "customer_count": 350}, {"customer_state": "TO", "customer_count": 280}, {"customer_state": "RO", "customer_count": 253}, {"customer_state": "AM", "customer_count": 148}, {"customer_state": "AC", "customer_count": 81}, {"customer_state": "AP", "customer_count": 68}, {"customer_state": "RR", "customer_count": 46}], "row_count": 27, "limit_applied": false}, "output": {"text": "Distribuição de clientes por estado:\n  SP: 41.746\n  RJ: 12.852\n  MG: 11.635\n  RS: 5.466\n  PR: 5.045\n  SC: 3.637\n  BA: 3.380\n  DF: 2.140\n  ES: 2.033\n  GO: 2.020\n  PE: 1.652\n  CE: 1.336\n  PA: 975\n  MT: 907\n  MA: 747\n  MS: 715\n  PB: 536\n  PI: 495\n  RN: 485\n  AL: 413\n  SE: 350\n  TO: 280\n  RO: 253\n  AM: 148\n  AC: 81\n  AP: 68\n  RR: 46\n\nTotal: 99.441 clientes em 27 estados.", "meta": {"sql": "SELECT customer_state, COUNT(*) AS customer_count FROM analytics.customers GROUP BY customer_state ORDER BY customer_count DESC", "row_count": 27, "limit_applied": false}}}
{"input": {"user_query": "Quantos clientes fizeram mais de 3 pedidos?", "sql": "SELECT COUNT(*) FROM (SELECT customer_id FROM analytics.orders GROUP BY customer_id HAVING COUNT(order_id) > 3) subquery", "rows": [], "row_count": 0, "limit_applied": false}, "output": {"text": "Não há clientes com mais de 3 pedidos no sistema. Análise dos dados: todos os clientes fizeram no máximo 3 pedidos cada.", "meta": {"sql": "SELECT COUNT(*) FROM (SELECT customer_id FROM analytics.orders GROUP BY customer_id HAVING COUNT(order_id) > 3) subquery", "row_count": 0, "limit_applied": false}}}
{"input": {"user_query": "Tempo médio de entrega por transportadora", "sql": "SELECT seller_id, AVG(delivery_time) AS avg_time FROM analytics.orders GROUP BY seller_id", "rows": [{"seller_id": "s_001", "avg_time": "2 days 14:30:00"}, {"seller_id": "s_002", "avg_time": "1 day 08:15:00"}], "row_count": 2, "limit_applied": false}, "output": {"text": "Tempo médio de entrega por vendedor:\n  s_001: 2 dias e 14 horas\n  s_002: 1 dia e 8 horas\n\nMédia geral: 1,9 dias de entrega.", "meta": {"sql": "SELECT seller_id, AVG(delivery_time) AS avg_time FROM analytics.orders GROUP BY seller_id", "row_count": 2, "limit_applied": false}}}
{"input": {"user_query": "Gargalos operacionais em pedidos", "sql": "SELECT order_id, processing_time FROM analytics.orders WHERE delivered_date IS NOT NULL ORDER BY processing_time DESC", "rows": [{"order_id": "o_001", "processing_time": 72.5}], "row_count": 1, "limit_applied": false}, "output": {"text": "Análise de gargalos operacionais:\n\nPedido com maior tempo de processamento:\n  o_001: 72,5 horas (3 dias)\n\nRecomendação: Investigar o processo deste pedido para identificar possíveis melhorias.", "meta": {"sql": "SELECT order_id, processing_time FROM analytics.orders WHERE delivered_date IS NOT NULL ORDER BY processing_time DESC", "row_count": 1, "limit_applied": false}}}
{"input": {"user_query": "Identifique padrões sazonais de compra por categoria de produto ao longo do ano", "sql": "SELECT pc.product_category_name, DATE_TRUNC('month', o.order_purchase_timestamp) AS period, COUNT(*) AS purchase_count FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.products p ON oi.product_id = p.product_id JOIN analytics.product_category_translation pc ON p.product_category_name = pc.product_category_name GROUP BY pc.product_category_name, DATE_TRUNC('month', o.order_purchase_timestamp) ORDER BY period, purchase_count DESC", "rows": [{"product_category_name": "beleza_saude", "period": "2016-09-01T00:00:00", "purchase_count": 3}, {"product_category_name": "moveis_decoracao", "period": "2016-09-01T00:00:00", "purchase_count": 2}, {"product_category_name": "beleza_saude", "period": "2016-10-01T00:00:00", "purchase_count": 48}, {"product_category_name": "moveis_decoracao", "period": "2016-10-01T00:00:00", "purchase_count": 67}, {"product_category_name": "beleza_saude", "period": "2017-01-01T00:00:00", "purchase_count": 85}, {"product_category_name": "moveis_decoracao", "period": "2017-01-01T00:00:00", "purchase_count": 182}], "row_count": 6, "limit_applied": false}, "output": {"text": "Análise de padrões sazonais de compra por categoria:\n\nPrincipais insights (6 registros):\n  Total: 387\n  Média: 64,50\n  Máximo: 182\n  Mínimo: 2\n\nAnálise de padrões temporais (3 períodos analisados):\n\nPeríodos com maior atividade:\n  2017-01-01T00:00:00: 267\n  2016-10-01T00:00:00: 115\n  2016-09-01T00:00:00: 5\n\nPeríodo analisado: 2016-09-01T00:00:00 a 2017-01-01T00:00:00\n\nDados completos:\n1. product_category_name: beleza_saude, period: 2016-09-01T00:00:00, purchase_count: 3\n2. product_category_name: moveis_decoracao, period: 2016-09-01T00:00:00, purchase_count: 2\n3. product_category_name: beleza_saude, period: 2016-10-01T00:00:00, purchase_count: 48\n4. product_category_name: moveis_decoracao, period: 2016-10-01T00:00:00, purchase_count: 67\n5. product_category_name: beleza_saude, period: 2017-01-01T00:00:00, purchase_count: 85\n6. product_category_name: moveis_decoracao, period: 2017-01-01T00:00:00, purchase_count: 182", "meta": {"sql": "SELECT pc.product_category_name, DATE_TRUNC('month', o.order_purchase_timestamp) AS period, COUNT(*) AS purchase_count FROM analytics.orders o JOIN analytics.order_items oi ON o.order_id = oi.order_id JOIN analytics.products p ON oi.product_id = p.product_id JOIN analytics.product_category_translation pc ON p.product_category_name = pc.product_category_name GROUP BY pc.product_category_name, DATE_TRUNC('month', o.order_purchase_timestamp) ORDER BY period, purchase_count DESC", "row_count": 6, "limit_applied": false}}}
