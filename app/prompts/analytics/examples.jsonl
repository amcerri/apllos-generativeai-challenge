{"input": "Receita mensal em 2017 considerando order_items.price + order_items.freight_value e a data orders.order_purchase_timestamp.", "output": {"sql": "SELECT date_trunc('month', o.order_purchase_timestamp) AS period, SUM(oi.price + oi.freight_value) AS revenue FROM orders o JOIN order_items oi ON o.order_id = oi.order_id WHERE o.order_purchase_timestamp >= '2017-01-01' AND o.order_purchase_timestamp < '2018-01-01' GROUP BY period ORDER BY period", "params": {"year": 2017}, "reason": "monthly revenue for 2017 using orders timestamp and items price+freight", "limit_applied": false, "warnings": []}}
{"input": "Top 5 categorias por faturamento (R$).", "output": {"sql": "SELECT p.product_category_name AS category, SUM(oi.price + oi.freight_value) AS revenue FROM order_items oi JOIN products p ON oi.product_id = p.product_id GROUP BY category ORDER BY revenue DESC LIMIT 5", "params": {"top": 5}, "reason": "top-N categories by revenue", "limit_applied": false, "warnings": []}}
{"input": "Frete médio por estado do cliente.", "output": {"sql": "SELECT c.customer_state AS state, AVG(oi.freight_value) AS avg_freight FROM orders o JOIN customers c ON o.customer_id = c.customer_id JOIN order_items oi ON o.order_id = oi.order_id GROUP BY state ORDER BY state", "params": {}, "reason": "average freight by customer state", "limit_applied": false, "warnings": []}}
{"input": "Listar meus pedidos mais recentes (customer_id = 'CUST123').", "output": {"sql": "SELECT o.order_id, o.order_status, o.order_purchase_timestamp FROM orders o WHERE o.customer_id = 'CUST123' ORDER BY o.order_purchase_timestamp DESC LIMIT 200", "params": {"customer_id": "CUST123"}, "reason": "sample recent orders for a specific customer with cap", "limit_applied": true, "warnings": []}}
{"input": "Pedidos por dia em junho/2018.", "output": {"sql": "SELECT date_trunc('day', o.order_purchase_timestamp) AS period, COUNT(*) AS orders FROM orders o WHERE o.order_purchase_timestamp >= '2018-06-01' AND o.order_purchase_timestamp < '2018-07-01' GROUP BY period ORDER BY period", "params": {"from": "2018-06-01", "to": "2018-07-01"}, "reason": "daily order volume in June 2018", "limit_applied": false, "warnings": []}}
{"input": "Taxa de cancelamento geral.", "output": {"sql": "SELECT 100.0 * SUM(CASE WHEN o.order_status = 'canceled' THEN 1 ELSE 0 END) / NULLIF(COUNT(*), 0) AS cancel_rate FROM orders o", "params": {}, "reason": "cancellation rate over all orders", "limit_applied": false, "warnings": []}}
{"input": "Média de review por mês.", "output": {"sql": "SELECT date_trunc('month', o.order_purchase_timestamp) AS period, AVG(r.review_score) AS avg_score FROM orders o JOIN order_reviews r ON o.order_id = r.order_id GROUP BY period ORDER BY period", "params": {}, "reason": "monthly average review score", "limit_applied": false, "warnings": []}}
{"input": "Top 10 sellers por receita em 2017.", "output": {"sql": "SELECT oi.seller_id, SUM(oi.price + oi.freight_value) AS revenue FROM orders o JOIN order_items oi ON o.order_id = oi.order_id WHERE o.order_purchase_timestamp >= '2017-01-01' AND o.order_purchase_timestamp < '2018-01-01' GROUP BY oi.seller_id ORDER BY revenue DESC LIMIT 10", "params": {"year": 2017, "top": 10}, "reason": "top sellers by revenue for 2017", "limit_applied": false, "warnings": []}}
{"input": "Distribuição por tipo de pagamento.", "output": {"sql": "SELECT op.payment_type, COUNT(*) AS cnt, 100.0 * COUNT(*) / NULLIF(SUM(COUNT(*)) OVER (), 0) AS pct FROM order_payments op GROUP BY op.payment_type ORDER BY cnt DESC", "params": {}, "reason": "payment type distribution with count and share", "limit_applied": false, "warnings": []}}
{"input": "Margem bruta por categoria.", "output": {"sql": "SELECT p.product_category_name AS category, SUM(oi.price + oi.freight_value) AS revenue FROM order_items oi JOIN products p ON oi.product_id = p.product_id GROUP BY category ORDER BY revenue DESC", "params": {}, "reason": "approximate revenue by category; requested field not available", "limit_applied": false, "warnings": ["invalid_column:gross_margin"]}}
{"input": "Explique o que é o status 'delivered'.", "output": {"sql": "SELECT 1 AS noop LIMIT 1", "params": {}, "reason": "non analytical intent; safe minimal query", "limit_applied": true, "warnings": ["non_analytical_intent"]}}
{"input": "Contar itens por pedido na tabela orders_items.", "output": {"sql": "SELECT oi.order_id, COUNT(*) AS item_count FROM order_items oi GROUP BY oi.order_id ORDER BY item_count DESC", "params": {}, "reason": "item count per order using order_items table", "limit_applied": false, "warnings": ["invalid_table:orders_items"]}}
{"input": "Clientes distintos em 2017.", "output": {"sql": "SELECT COUNT(DISTINCT o.customer_id) AS distinct_customers FROM orders o WHERE o.order_purchase_timestamp >= '2017-01-01' AND o.order_purchase_timestamp < '2018-01-01'", "params": {"year": 2017}, "reason": "distinct customers for 2017", "limit_applied": false, "warnings": []}}
{"input": "Top 10 produtos por volume.", "output": {"sql": "SELECT oi.product_id, COUNT(*) AS items FROM order_items oi GROUP BY oi.product_id ORDER BY items DESC LIMIT 10", "params": {"top": 10}, "reason": "top products by item count", "limit_applied": false, "warnings": []}}
{"input": "Pedidos entregues por estado do vendedor.", "output": {"sql": "SELECT s.seller_state AS state, COUNT(*) AS delivered_orders FROM orders o JOIN order_items oi ON o.order_id = oi.order_id JOIN sellers s ON oi.seller_id = s.seller_id WHERE o.order_status = 'delivered' GROUP BY state ORDER BY delivered_orders DESC", "params": {}, "reason": "delivered orders grouped by seller state", "limit_applied": false, "warnings": []}}
